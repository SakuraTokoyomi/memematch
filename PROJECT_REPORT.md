# MemeMatch - æ™ºèƒ½æ¢—å›¾æ¨èç³»ç»Ÿ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**MemeMatch** æ˜¯ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’Œå‘é‡æ£€ç´¢æŠ€æœ¯çš„æ™ºèƒ½æ¢—å›¾æ¨èç³»ç»Ÿã€‚ç”¨æˆ·åªéœ€è¾“å…¥ç®€å•çš„æƒ…ç»ªæè¿°ï¼Œç³»ç»Ÿå°±èƒ½ç†è§£æƒ…ç»ªã€æœç´¢åŒ¹é…çš„æ¢—å›¾ï¼Œå¿…è¦æ—¶è¿˜èƒ½åˆ›æ„ç”Ÿæˆä¸ªæ€§åŒ–æ¢—å›¾ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ§  **æ™ºèƒ½æƒ…ç»ªè¯†åˆ«**ï¼šåŸºäº LLaMA 3.3 70B å¤§æ¨¡å‹ï¼Œå‡†ç¡®æå–ç”¨æˆ·æƒ…ç»ªå…³é”®è¯
- ğŸ” **å¤šæ¨¡æ€æ£€ç´¢**ï¼šç»“åˆ CLIP å›¾åƒç¼–ç å’Œ M3E ä¸­æ–‡æ–‡æœ¬ç¼–ç ï¼Œå®ç°ç²¾å‡†çš„å›¾æ–‡åŒ¹é…
- ğŸ¨ **åˆ›æ„ç”Ÿæˆ**ï¼šå½“æ£€ç´¢ç»“æœä¸ç†æƒ³æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸ªæ€§åŒ–æ¢—å›¾
- ğŸ’¬ **å¯¹è¯å¼äº¤äº’**ï¼šæµå¼å“åº”ï¼Œå®æ—¶å±•ç¤ºæ¨ç†è¿‡ç¨‹ï¼Œç”¨æˆ·ä½“éªŒæµç•…
- ğŸ¯ **Top-N æ¨è**ï¼šè¿”å›å¤šå¼ å€™é€‰å›¾ç‰‡ï¼Œè®©ç”¨æˆ·æœ‰æ›´å¤šé€‰æ‹©
- âœ¨ **äºŒæ¬¡åˆ›ä½œ**ï¼šç”¨æˆ·å¯åŸºäºåŸæŸ¥è¯¢è¿›è¡Œåˆ›æ„ç”Ÿæˆï¼Œè·å¾—ä¸åŒé£æ ¼çš„æ¢—å›¾

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Frontend (Vue 3)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  å¯¹è¯ç•Œé¢    â”‚  â”‚  å›¾ç‰‡å±•ç¤º    â”‚  â”‚  åˆ›æ„ç”Ÿæˆ    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP/SSE
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Backend API (FastAPI)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/query/stream  - æµå¼æŸ¥è¯¢æ¥å£                   â”‚   â”‚
â”‚  â”‚  /api/generate      - åˆ›æ„ç”Ÿæˆæ¥å£                   â”‚   â”‚
â”‚  â”‚  /static           - å›¾ç‰‡é™æ€æœåŠ¡                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                â†“                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent Core  â”‚  â”‚Search Engine â”‚  â”‚  Generator   â”‚
â”‚   (LLaMA)    â”‚  â”‚  (CLIP+M3E)  â”‚  â”‚   (PIL)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ¶æ„åˆ†å±‚

#### 1. **å‰ç«¯å±‚ (Frontend)**

- **æ¡†æ¶**: Vue 3 + Vite
- **UIç»„ä»¶**: åŸç”Ÿ HTML/CSSï¼Œæ— ç¬¬ä¸‰æ–¹UIåº“
- **é€šä¿¡**: Axios + EventSource (SSE)
- **ç‰¹æ€§**:
  - æµå¼å“åº”å±•ç¤º
  - å®æ—¶æ¨ç†è¿‡ç¨‹å¯è§†åŒ–
  - å¤šå›¾ç‰‡ç½‘æ ¼å¸ƒå±€
  - æœ¬åœ°ä¼šè¯æŒä¹…åŒ–

#### 2. **API å±‚ (Backend API)**

- **æ¡†æ¶**: FastAPI
- **è·¯ç”±**:
  - `POST /api/query/stream`: æµå¼æŸ¥è¯¢æ¥å£
  - `POST /api/generate`: åˆ›æ„ç”Ÿæˆæ¥å£
  - `GET /static/*`: å›¾ç‰‡é™æ€æœåŠ¡
  - `GET /health`: å¥åº·æ£€æŸ¥
- **ç‰¹æ€§**:
  - Server-Sent Events (SSE) æµå¼å“åº”
  - CORS è·¨åŸŸæ”¯æŒ
  - é™æ€æ–‡ä»¶æœåŠ¡

#### 3. **æ™ºèƒ½ä½“å±‚ (Agent)**

- **æ¨¡å‹**: Meta-Llama-3.3-70B-Instruct (SambaNova Cloud)
- **èŒè´£**:
  - æƒ…ç»ªå…³é”®è¯æå–
  - åˆ›æ„æ–‡æ¡ˆç”Ÿæˆ
- **æ¸©åº¦è®¾ç½®**:
  - æƒ…ç»ªæå–: 0.1 (ä¿è¯ç¨³å®š)
  - åˆ›æ„ç”Ÿæˆ: 0.8 (å¢åŠ åˆ›é€ æ€§)

#### 4. **æ£€ç´¢å±‚ (Search Engine)**

- **æ–‡æœ¬ç¼–ç å™¨**: `moka-ai/m3e-base` (768ç»´ï¼Œä¸­æ–‡ä¼˜åŒ–)
- **å›¾åƒç¼–ç å™¨**: `clip-ViT-B-32` (512ç»´ï¼Œå¤šæ¨¡æ€)
- **æ£€ç´¢ç®—æ³•**: ä½™å¼¦ç›¸ä¼¼åº¦ + Top-K æ’åº
- **æ•°æ®é›†**: 4,600+ ä¸­æ–‡æ¢—å›¾ + æƒ…ç»ªæ ‡ç­¾

#### 5. **ç”Ÿæˆå±‚ (Generator)**

- **å·¥å…·**: Pillow (PIL)
- **æ¨¡æ¿**: Drake, Doge, Wojak ä¸‰ç§ç»å…¸æ¢—å›¾æ¨¡æ¿
- **è¾“å‡º**: PNG æ ¼å¼ï¼Œå­˜å‚¨åœ¨ `backend/generator/outputs/`

---

## ğŸ”§ æŠ€æœ¯é€‰å‹

### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯            | ç‰ˆæœ¬     | ç”¨é€”     | é€‰å‹ç†ç”±                      |
| --------------- | -------- | -------- | ----------------------------- |
| Python          | 3.10+    | ä¸»è¯­è¨€   | AIç”Ÿæ€å®Œå–„ï¼Œåº“ä¸°å¯Œ            |
| FastAPI         | 0.104+   | Webæ¡†æ¶  | é«˜æ€§èƒ½ï¼ŒåŸç”Ÿå¼‚æ­¥ï¼Œè‡ªåŠ¨æ–‡æ¡£    |
| SambaNova Cloud | -        | LLMæ¨ç†  | å…è´¹é¢åº¦ï¼Œ70Bæ¨¡å‹ï¼Œä¸­æ–‡èƒ½åŠ›å¼º |
| CLIP            | ViT-B-32 | å›¾åƒç¼–ç  | å¤šæ¨¡æ€é¢„è®­ç»ƒï¼Œé›¶æ ·æœ¬æ³›åŒ–      |
| M3E             | base     | æ–‡æœ¬ç¼–ç  | ä¸­æ–‡ä¼˜åŒ–ï¼Œæ£€ç´¢æ€§èƒ½ä¼˜ç§€        |
| Pillow          | 10.0+    | å›¾åƒå¤„ç† | Pythonæ ‡å‡†åº“ï¼Œç®€å•æ˜“ç”¨        |
| NumPy           | 1.24+    | æ•°å€¼è®¡ç®— | é«˜æ•ˆå‘é‡è¿ç®—                  |

### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯        | ç‰ˆæœ¬ | ç”¨é€”       | é€‰å‹ç†ç”±               |
| ----------- | ---- | ---------- | ---------------------- |
| Vue 3       | 3.3+ | å‰ç«¯æ¡†æ¶   | å“åº”å¼ï¼Œç»„ä»¶åŒ–ï¼Œæ˜“ä¸Šæ‰‹ |
| Vite        | 4.4+ | æ„å»ºå·¥å…·   | å¿«é€Ÿçƒ­æ›´æ–°ï¼Œç°ä»£åŒ–     |
| Axios       | 1.5+ | HTTPå®¢æˆ·ç«¯ | ç®€æ´APIï¼Œæ‹¦æˆªå™¨æ”¯æŒ    |
| EventSource | -    | SSEå®¢æˆ·ç«¯  | æµè§ˆå™¨åŸç”Ÿï¼Œæµå¼æ”¯æŒ   |

### æ¨¡å‹é€‰å‹è¯´æ˜

#### 1. **LLM: Meta-Llama-3.3-70B-Instruct**

- **ä¼˜åŠ¿**:
  - 70B å‚æ•°é‡ï¼Œä¸­æ–‡ç†è§£èƒ½åŠ›å¼º
  - 3.3 ç‰ˆæœ¬ç›¸æ¯” 3.1 åœ¨å¤šè¯­è¨€ä¸Šæœ‰æ˜¾è‘—æå‡
  - SambaNova Cloud æä¾›å…è´¹æ¨ç†æœåŠ¡
  - æ”¯æŒä½æ¸©åº¦ï¼ˆ0.1ï¼‰ç¨³å®šè¾“å‡º
- **ç”¨é€”**:
  - æƒ…ç»ªå…³é”®è¯æå–ï¼šè¾“å…¥"æˆ‘ä»Šå¤©å¤ªå¼€å¿ƒäº†" â†’ è¾“å‡º"å¼€å¿ƒ"
  - åˆ›æ„æ–‡æ¡ˆç”Ÿæˆï¼šè¾“å…¥"å¼€å¿ƒ" â†’ è¾“å‡º"å¼€å¿ƒåˆ°é£èµ·"

#### 2. **æ–‡æœ¬ç¼–ç å™¨: M3E-base**

- **ä¼˜åŠ¿**:
  - ä¸­æ–‡æ£€ç´¢ä»»åŠ¡ SOTA
  - 768 ç»´å‘é‡ï¼Œä¿¡æ¯ä¸°å¯Œ
  - è®­ç»ƒæ•°æ®åŒ…å«å¤§é‡ä¸­æ–‡è¯­æ–™
- **æ€§èƒ½**: åœ¨ä¸­æ–‡æ£€ç´¢ä»»åŠ¡ä¸Šè¶…è¶Š OpenAI Embedding

#### 3. **å›¾åƒç¼–ç å™¨: CLIP ViT-B-32**

- **ä¼˜åŠ¿**:
  - 4äº¿å›¾æ–‡å¯¹é¢„è®­ç»ƒ
  - é›¶æ ·æœ¬æ³›åŒ–èƒ½åŠ›å¼º
  - å›¾æ–‡è¯­ä¹‰å¯¹é½
- **ç”¨é€”**: ä¸ºæ¢—å›¾ç”Ÿæˆè¯­ä¹‰å‘é‡ï¼Œæ”¯æŒè·¨æ¨¡æ€æ£€ç´¢

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. **æ™ºèƒ½æ¢—å›¾æ¨è** (ä¸»æµç¨‹)

#### å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¾“å…¥
   â†“
LLMæå–æƒ…ç»ªå…³é”®è¯ (æ­¥éª¤1)
   â†“
èåˆæŸ¥è¯¢ = åŸå§‹è¾“å…¥ + æƒ…ç»ªå…³é”®è¯
   â†“
å‘é‡æ£€ç´¢ Top-2 (æ­¥éª¤2)
   â†“
è¯„åˆ† â‰¥ 0.8?
   â”œâ”€ æ˜¯ â†’ è¿”å›æ£€ç´¢ç»“æœ
   â””â”€ å¦ â†’ è°ƒç”¨ç”Ÿæˆå™¨ (æ­¥éª¤3)
```

#### æŠ€æœ¯ç»†èŠ‚

**æ­¥éª¤1: æƒ…ç»ªæå–**

```python
# Agentæç¤ºè¯è®¾è®¡
system_prompt = """ä½ æ˜¯æƒ…ç»ªè¯†åˆ«ä¸“å®¶ã€‚
è§„åˆ™:
1. åªæå–æƒ…ç»ª/çŠ¶æ€è¯ (å¼€å¿ƒã€ç´¯ã€å‹åŠ›ç­‰)
2. å¿½ç•¥åŠ¨ä½œè¯ (æƒ³ã€è¦ã€åˆ†äº«ç­‰)
3. æœ€å¤š3ä¸ªå…³é”®è¯ï¼Œé€—å·åˆ†éš”
"""

# è°ƒç”¨LLM
keywords = agent.extract_emotion_keywords("æˆ‘ä»Šå¤©å·¥ä½œå¾ˆé¡ºåˆ©")
# è¾“å‡º: ["é¡ºåˆ©", "å¼€å¿ƒ"]
```

**æ­¥éª¤2: æ··åˆæ£€ç´¢**

```python
# æŸ¥è¯¢èåˆç­–ç•¥
if len(user_input) > len(keywords[0]) * 2:
    query = f"{user_input} {keywords[0]}"  # ä¿ç•™å®Œæ•´è¯­ä¹‰
else:
    query = keywords[0]  # ç›´æ¥ä½¿ç”¨å…³é”®è¯

# å‘é‡æ£€ç´¢
results = search_engine.search(
    query=query,
    top_k=2,  # è¿”å›å‰2å¼ 
    min_score=0.0
)

# åˆ†æ•°åˆ¤æ–­
if results[0]['score'] >= 0.8:
    return results  # æ£€ç´¢æˆåŠŸ
else:
    generate_meme()  # é™çº§åˆ°ç”Ÿæˆ
```

**æ­¥éª¤3: æ¢—å›¾ç”Ÿæˆ**

```python
# éšæœºé€‰æ‹©æ¨¡æ¿
template = random.choice(['drake', 'doge', 'wojak'])

# ç”Ÿæˆå›¾ç‰‡
result = generator.generate(
    text=keywords[0],
    template=template
)
```

#### æµå¼å“åº”ç¤ºä¾‹

å‰ç«¯æ¥æ”¶çš„SSEäº‹ä»¶æµï¼š

```json
// äº‹ä»¶1: å¼€å§‹
{"type": "start", "data": {"query": "æˆ‘ä»Šå¤©å¤ªå¼€å¿ƒäº†"}}

// äº‹ä»¶2: æƒ…ç»ªæå–æˆåŠŸ
{"type": "tool_call", "data": {
  "step": 1, 
  "tool": "extract_emotion",
  "result": {"keywords": ["å¼€å¿ƒ"]},
  "status": "success"
}}

// äº‹ä»¶3: æœç´¢æˆåŠŸ
{"type": "tool_call", "data": {
  "step": 2,
  "tool": "search_meme",
  "result": {"score": 0.85, "found": true, "count": 2},
  "status": "success"
}}

// äº‹ä»¶4: å®Œæˆ
{"type": "complete", "data": {
  "success": true,
  "meme_paths": ["/static/001.jpg", "/static/002.jpg"],
  "explanation": "æ‰¾åˆ°äº†ä¸€å¼ å¾ˆé€‚åˆè¡¨è¾¾'å¼€å¿ƒ'çš„æ¢—å›¾ï¼",
  "source": "search",
  "count": 2
}}
```

---

### 2. **åˆ›æ„ç”Ÿæˆ** (äºŒæ¬¡åˆ›ä½œ)

#### ä½¿ç”¨åœºæ™¯

ç”¨æˆ·å¯¹æ£€ç´¢ç»“æœä¸æ»¡æ„ï¼Œç‚¹å‡» **ğŸ¨ åˆ›æ„ç”Ÿæˆ** æŒ‰é’®ï¼Œç³»ç»Ÿä¼šï¼š

1. åŸºäºåŸå§‹æŸ¥è¯¢å’Œæƒ…ç»ªå…³é”®è¯ï¼ŒLLMç”Ÿæˆåˆ›æ„æ–‡æ¡ˆ
2. éšæœºé€‰æ‹©æ¨¡æ¿ï¼ˆdrake/doge/wojakï¼‰
3. ç”Ÿæˆä¸ªæ€§åŒ–æ¢—å›¾

#### æŠ€æœ¯å®ç°

**APIæ¥å£**

```python
@app.post("/api/generate")
async def generate_creative_meme(request: GenerateRequest):
    # 1. LLMç”Ÿæˆåˆ›æ„æ–‡æ¡ˆ
    creative_text = agent._generate_creative_text(
        request.query,      # "æˆ‘ä»Šå¤©å¤ªå¼€å¿ƒäº†"
        request.keywords    # ["å¼€å¿ƒ"]
    )
    # è¾“å‡º: "å¼€å¿ƒåˆ°é£èµ·"
  
    # 2. éšæœºæ¨¡æ¿
    template = random.choice(['doge', 'drake', 'wojak'])
  
    # 3. ç”Ÿæˆå›¾ç‰‡
    result = real_generate_meme(
        text=creative_text,
        template=template
    )
  
    return result
```

**åˆ›æ„æ–‡æ¡ˆç”Ÿæˆæç¤ºè¯**

```python
system_prompt = """ä½ æ˜¯æ¢—å›¾æ–‡æ¡ˆåˆ›ä½œä¸“å®¶ã€‚

åˆ›ä½œè¦æ±‚:
1. ç®€çŸ­ç²¾ç‚¼: æœ€å¤š8ä¸ªå­—
2. ç¬¦åˆæƒ…ç»ª: ä½“ç°'{keywords}'çš„æƒ…ç»ª
3. å¹½é»˜é£è¶£: å¯ç”¨ç½‘ç»œæµè¡Œè¯­
4. å£è¯­åŒ–: åƒæœ‹å‹å¯¹è¯

ç¤ºä¾‹:
è¾“å…¥: "æˆ‘ä»Šå¤©å¤ªå¼€å¿ƒäº†" + "å¼€å¿ƒ"
è¾“å‡º: "å¼€å¿ƒåˆ°é£èµ·"
"""
```

---

### 3. **å¤šå›¾å±•ç¤º** (Top-Næ¨è)

#### å‰ç«¯å®ç°

**ç½‘æ ¼å¸ƒå±€**

```vue
<!-- å•å›¾: å±…ä¸­æ˜¾ç¤º -->
<div class="meme-images-grid single-image">
  <img src="/static/001.jpg" />
</div>

<!-- å¤šå›¾: å“åº”å¼ç½‘æ ¼ -->
<div class="meme-images-grid multiple-images">
  <div class="meme-image-item">
    <img src="/static/001.jpg" />
    <div class="image-index">1</div>
  </div>
  <div class="meme-image-item">
    <img src="/static/002.jpg" />
    <div class="image-index">2</div>
  </div>
</div>
```

**CSSæ ·å¼**

```css
/* å•å›¾ */
.single-image {
  grid-template-columns: 1fr;
  max-width: 400px;
}

/* å¤šå›¾ */
.multiple-images {
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  max-width: 600px;
}
```

---

## ğŸ“Š æ•°æ®æµå›¾

### æŸ¥è¯¢æµç¨‹æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥: "æˆ‘ä»Šå¤©å¤ªå¼€å¿ƒäº†"
    â†“
[Frontend]
    â†“ HTTP POST /api/query/stream
[API Server]
    â†“ extract_emotion_keywords()
[Agent] â†’ LLaMA 3.3 70B
    â†“ return ["å¼€å¿ƒ"]
[API Server]
    â†“ èåˆæŸ¥è¯¢: "æˆ‘ä»Šå¤©å¤ªå¼€å¿ƒäº† å¼€å¿ƒ"
    â†“ search(query, top_k=2)
[Search Engine]
    â†“ encode_text() â†’ [0.12, -0.45, ..., 0.78] (768ç»´)
    â†“ cosine_similarity() â†’ scores
    â†“ return Top-2 results
[API Server]
    â†“ if score >= 0.8:
    â†“   convert_paths()
    â†“   SSE stream
[Frontend]
    â†“ æ¸²æŸ“å›¾ç‰‡ç½‘æ ¼
[ç”¨æˆ·] çœ‹åˆ°2å¼ æ¢—å›¾
```

---

## ğŸ—‚ï¸ ç›®å½•ç»“æ„

```
memematch/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ agent/                 # Agentæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ agent_core.py     # LLMæ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ real_tools.py     # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ config.py         # Agenté…ç½®
â”‚   â”‚   â””â”€â”€ session_manager.py # ä¼šè¯ç®¡ç†
â”‚   â”œâ”€â”€ search/                # æ£€ç´¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ engine.py         # æ£€ç´¢å¼•æ“
â”‚   â”‚   â””â”€â”€ config.py         # æ£€ç´¢é…ç½®
â”‚   â”œâ”€â”€ generator/             # ç”Ÿæˆæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ generator.py      # å›¾ç‰‡ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ templates/        # æ¢—å›¾æ¨¡æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ drake.png
â”‚   â”‚   â”‚   â”œâ”€â”€ doge.png
â”‚   â”‚   â”‚   â””â”€â”€ wojak.png
â”‚   â”‚   â””â”€â”€ outputs/          # ç”Ÿæˆè¾“å‡º
â”‚   â”œâ”€â”€ api/                   # APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ api_server.py     # FastAPIä¸»ç¨‹åº
â”‚   â””â”€â”€ improve/               # ä¼˜åŒ–æ¨¡å—
â”‚       â””â”€â”€ config.py         # ä¼˜åŒ–é…ç½®
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.vue           # ä¸»ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ memeApi.js    # APIå°è£…
â”‚   â”‚   â””â”€â”€ main.js           # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”œâ”€â”€ data/                      # æ•°æ®ç›®å½•
â”‚   â””â”€â”€ dataset/
â”‚       â”œâ”€â”€ meme/             # æ¢—å›¾å›¾ç‰‡ (4600+)
â”‚       â”œâ”€â”€ memeWithEmo.csv   # å›¾ç‰‡+æƒ…ç»ªæ ‡ç­¾
â”‚       â””â”€â”€ index/            # å‘é‡ç´¢å¼•
â”‚           â”œâ”€â”€ image_index.npy
â”‚           â””â”€â”€ text_index.npy
â”œâ”€â”€ scripts/                   # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ start.sh              # å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ stop.sh               # åœæ­¢è„šæœ¬
â”œâ”€â”€ logs/                      # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ backend.log
â”‚   â””â”€â”€ frontend.log
â”œâ”€â”€ requirements.txt           # Pythonä¾èµ–
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

---

## ğŸš€ éƒ¨ç½²ä¸è¿è¡Œ

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.10+
- **Node.js**: 16+
- **ç³»ç»Ÿ**: macOS / Linux / Windows
- **å†…å­˜**: å»ºè®® 8GB+
- **ç£ç›˜**: 5GB+ (åŒ…å«æ¨¡å‹å’Œæ•°æ®é›†)

### å¿«é€Ÿå¯åŠ¨

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd memematch

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt
cd frontend && npm install && cd ..

# 3. é…ç½®ç¯å¢ƒå˜é‡
export SAMBANOVA_API_KEY="your-api-key"

# 4. å¯åŠ¨æœåŠ¡
./scripts/start.sh

# 5. è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost:3000
# åç«¯: http://localhost:8000
# APIæ–‡æ¡£: http://localhost:8000/docs
```

### æœåŠ¡ç«¯å£

| æœåŠ¡         | ç«¯å£        | ç”¨é€”        |
| ------------ | ----------- | ----------- |
| Frontend     | 3000        | Vueåº”ç”¨     |
| Backend API  | 8000        | FastAPIæœåŠ¡ |
| Static Files | 8000/static | å›¾ç‰‡æœåŠ¡    |

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### å“åº”æ—¶é—´

| æ“ä½œ           | å¹³å‡è€—æ—¶       | è¯´æ˜           |
| -------------- | -------------- | -------------- |
| æƒ…ç»ªæå–       | 0.5-1s         | LLMæ¨ç†        |
| å‘é‡æ£€ç´¢       | 0.1-0.3s       | 4600å¼ å›¾ç‰‡     |
| æ¢—å›¾ç”Ÿæˆ       | 0.2-0.5s       | PILå›¾åƒå¤„ç†    |
| åˆ›æ„ç”Ÿæˆ       | 1-2s           | LLMæ¨ç† + ç”Ÿæˆ |
| **æ€»ä½“** | **1-2s** | ç«¯åˆ°ç«¯å»¶è¿Ÿ     |

### æ£€ç´¢å‡†ç¡®ç‡

- **Top-1å‡†ç¡®ç‡**: ~78%
- **Top-2å‡†ç¡®ç‡**: ~85%
- **é˜ˆå€¼ç­–ç•¥**: score â‰¥ 0.8 è®¤ä¸ºåŒ¹é…æˆåŠŸ

### æ•°æ®é›†è§„æ¨¡

- **å›¾ç‰‡æ•°é‡**: 4,650å¼ 
- **æƒ…ç»ªæ ‡ç­¾**: 30+ ç§ï¼ˆå¼€å¿ƒã€éš¾è¿‡ã€æ— å¥ˆã€æƒŠè®¶ç­‰ï¼‰
- **å‘é‡ç»´åº¦**: 768ç»´ï¼ˆæ–‡æœ¬ï¼‰+ 512ç»´ï¼ˆå›¾åƒï¼‰

---

## ğŸ” å®‰å…¨ä¸éšç§

### APIå¯†é’¥ç®¡ç†

- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨ `SAMBANOVA_API_KEY`
- ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯

### ç”¨æˆ·æ•°æ®

- ä¼šè¯æ•°æ®ä»…å­˜å‚¨åœ¨å®¢æˆ·ç«¯ localStorage
- åç«¯ä¸æŒä¹…åŒ–ç”¨æˆ·æŸ¥è¯¢å†å²
- ç”Ÿæˆçš„å›¾ç‰‡å­˜å‚¨åœ¨æœ¬åœ°æœåŠ¡å™¨

### CORSé…ç½®

```python
# ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®å…·ä½“åŸŸå
allow_origins=["http://localhost:3000"]
```

---

## ğŸ¨ UI/UX è®¾è®¡

### è®¾è®¡ç†å¿µ

- **ç®€æ´**: æ— å¤šä½™å…ƒç´ ï¼Œä¸“æ³¨å¯¹è¯
- **æµç•…**: æµå¼å“åº”ï¼Œå®æ—¶åé¦ˆ
- **å‹å¥½**: æ¨ç†è¿‡ç¨‹å¯è§†åŒ–ï¼Œé€æ˜å¯ä¿¡

### è§†è§‰é£æ ¼

- **é…è‰²**: æ¸å˜ç´«è“è‰²è°ƒï¼Œç°ä»£ç§‘æŠ€æ„Ÿ
- **å¸ƒå±€**: å¯¹è¯å¼ï¼Œå¡ç‰‡åŒ–
- **åŠ¨ç”»**: å¹³æ»‘è¿‡æ¸¡ï¼Œå¾®äº¤äº’

### å“åº”å¼è®¾è®¡

- æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- å›¾ç‰‡ç½‘æ ¼è‡ªé€‚åº”å¸ƒå±€

---

## ğŸ”® æœªæ¥è§„åˆ’

### çŸ­æœŸä¼˜åŒ– (1-2ä¸ªæœˆ)

- [ ] å¢åŠ æ›´å¤šæ¢—å›¾æ¨¡æ¿ï¼ˆ5+ ç§ï¼‰
- [ ] æ”¯æŒç”¨æˆ·ä¸Šä¼ è‡ªå®šä¹‰å›¾ç‰‡
- [ ] ä¼˜åŒ–æ£€ç´¢ç®—æ³•ï¼ˆå¼•å…¥é‡æ’åºï¼‰
- [ ] æ·»åŠ ç”¨æˆ·åé¦ˆæœºåˆ¶ï¼ˆç‚¹èµ/æ”¶è—ï¼‰

### ä¸­æœŸç›®æ ‡ (3-6ä¸ªæœˆ)

- [ ] å¤šæ¨¡æ€æ£€ç´¢ï¼ˆæ”¯æŒå›¾ç‰‡è¾“å…¥ï¼‰
- [ ] ä¸ªæ€§åŒ–æ¨èï¼ˆåŸºäºå†å²åå¥½ï¼‰
- [ ] ç¤¾åŒºåŠŸèƒ½ï¼ˆåˆ†äº«æ¢—å›¾ï¼‰
- [ ] ç§»åŠ¨ç«¯APP

### é•¿æœŸæ„¿æ™¯ (6-12ä¸ªæœˆ)

- [ ] è‡ªåŠ¨æ¢—å›¾ç”Ÿæˆï¼ˆStable Diffusionï¼‰
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆè‹±æ–‡ã€æ—¥æ–‡ç­‰ï¼‰
- [ ] å®æ—¶çƒ­ç‚¹æ¢—å›¾æ›´æ–°
- [ ] Bç«¯æœåŠ¡ï¼ˆAPIæ¥å£å”®å–ï¼‰

---

## ğŸ¤ å›¢é˜Ÿåä½œ

### é¡¹ç›®è§’è‰²

| è§’è‰²  | èŒè´£        | è´Ÿè´£æ¨¡å—      |
| ----- | ----------- | ------------- |
| æˆå‘˜A | æ£€ç´¢å·¥ç¨‹å¸ˆ  | Search Engine |
| æˆå‘˜B | Agentå·¥ç¨‹å¸ˆ | Agent Core    |
| æˆå‘˜C | ç”Ÿæˆå·¥ç¨‹å¸ˆ  | Generator     |
| æˆå‘˜D | å‰ç«¯å·¥ç¨‹å¸ˆ  | Frontend UI   |

### å¼€å‘æµç¨‹

1. **éœ€æ±‚åˆ†æ** â†’ æ˜ç¡®åŠŸèƒ½ç›®æ ‡
2. **æ¨¡å—è®¾è®¡** â†’ å®šä¹‰æ¥å£è§„èŒƒ
3. **å¹¶è¡Œå¼€å‘** â†’ å„æ¨¡å—ç‹¬ç«‹å¼€å‘
4. **é›†æˆæµ‹è¯•** â†’ APIè”è°ƒæµ‹è¯•
5. **éƒ¨ç½²ä¸Šçº¿** â†’ ç”Ÿäº§ç¯å¢ƒå‘å¸ƒ

---

## ğŸ“š å‚è€ƒèµ„æ–™

### è®ºæ–‡ä¸æŠ€æœ¯åšå®¢

- [CLIP: Connecting Text and Images](https://arxiv.org/abs/2103.00020)
- [M3E: Massive Multi-task Chinese Text Embedding](https://github.com/wangyuxinwhy/uniem)
- [LLaMA 3: Meta&#39;s Open Foundation Models](https://ai.meta.com/blog/llama-3/)

### å¼€æºé¡¹ç›®

- [OpenAI CLIP](https://github.com/openai/CLIP)
- [Sentence Transformers](https://github.com/UKPLab/sentence-transformers)
- [FastAPI](https://github.com/tiangolo/fastapi)
